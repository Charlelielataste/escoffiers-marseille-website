---
import { getAllNextEvents } from "@/lib/sanity-queries";
import { formatDate } from "@/lib/date";
import type { Locale } from "@/lib/i18n";

const { locale } = Astro.props as { locale: Locale };

const nextEvents = await getAllNextEvents();

if (nextEvents.length === 0) {
  return null;
}
---

<section class="relative py-20">
  <div class="max-w-6xl mx-auto px-4">
    <div class="relative">
      <div class="bg-container/90 backdrop-blur-sm shadow-2xl rounded-lg p-8">
        <h3 class="text-2xl font-semibold text-text-primary mb-6">
          Nos Événements à venir
        </h3>
        <div class="space-y-4">
          {
            nextEvents.map((event) => (
              <div class="flex flex-col space-y-2 border-t pt-4 first:border-t-0 border-secondary/50 first:pt-0">
                <div class="border font-medium border-secondary w-fit px-2 py-1 rounded-md text-secondary">
                  {formatDate(new Date(event.date), locale)}
                </div>
                <p class="font-medium text-lg">{event.title[locale]}</p>
                <p>{event.intro[locale]}</p>
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</section>
