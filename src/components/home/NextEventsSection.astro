---
import { getAllNextEvents } from "@/lib/sanity-queries";
import { formatDate } from "@/lib/date";
import { getTranslations, type Locale } from "@/lib/i18n";

const locale = Astro.currentLocale as Locale;

const nextEvents = await getAllNextEvents();

const t = getTranslations(locale);
if (nextEvents.length === 0) {
  return null;
}
---

<div class="relative">
  <div
    class="bg-white/90 backdrop-blur-sm shadow-lg rounded-lg p-8 border-2 border-secondary"
  >
    <h3 class="text-2xl font-semibold mb-6">
      {t.home.nextEventsSection.title}
    </h3>
    <div class="space-y-4">
      {
        nextEvents.map((event) => (
          <div class="flex flex-col space-y-2 border-t pt-4 first:border-t-0 border-secondary first:pt-0">
            <div class="font-bold border-2 border-secondary w-fit px-2 py-1 rounded-md">
              {formatDate(new Date(event.date), locale)}
            </div>
            <p class="font-medium text-lg">{event.title[locale]}</p>
            <p>{event.intro[locale]}</p>
          </div>
        ))
      }
    </div>
  </div>
</div>
